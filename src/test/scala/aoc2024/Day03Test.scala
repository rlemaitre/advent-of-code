package aoc2024

import helpers.{*, given}

class Day03Test extends munit.FunSuite:
    val testInput: String =
        """xmul(2,4)%&mul[3,7]!@^do_not_mul(5,5)+mul(32,64]then(mul(11,8)mul(8,5))
          |""".stripMargin
    test("part 1"):
        assertEquals(Day03.part1(testInput.parsed), 161L)
    test("part 2"):
        assertEquals(Day03.part2("xmul(2,4)&mul[3,7]!^don't()_mul(5,5)+mul(32,64](mul(11,8)undo()?mul(8,5))".parsed), 48L)
    test("part 2 first line"):
        val value = "-select()&how()''from()}what()mul(667,142);*when()*/%%+ &mul(139,116),,)mul(665,813)$>-+from()where(),from()mul(589,293))mul(832,177)mul(701,929)~([mul(300,986)from()mul(238,716)/~*~'what()when():}mul(437,789)mul(662,564)*)^,;%<}#'mul(567,346)don't()from()-who(),^/mul(939,542)mul(944,786)^}select()(mul(508,210)}mul(873,534)}select()where()-,*+)#@mul(925,280)where()*who()why()who()?%:mul(858,972)+mul(113,350)' *who()+from(641,444))&]*don't();from()+,@[mul(522,403)mul(627,14)why()where()+/#^!what()^mul(678,234) <mul(520,505):how()()[from()select()mul(500,879)~{:-:{~mul(163,615)[~;>mul(79,303)from()from()^'who()@;/~[mul(752,220);-don't()((select()select(){mul(454,158) *]#mul(387,262)how()where()<select()#]mul(904,366)]?<what()>when()[from(118,182)mul(662,176)%]')from()where()mul(259,178)--)~>$who()do()where()&&]~@{)%]mul(566,269);select()%}%+ mul(21,147),#&)*'why()#+don't()-,:{/%what()$*mul(883,511)select(264,142)select()how()]/?&&mul(205,770)select()%from()what()&$select()who())mul(538,114)/mul(9,272)from()?(why(727,269)when()don't()>+/ when(),)mul(750,773)*['do()]mul(316,235)+{{mul(744,197)*#who()*}how()how()why())mul(932,794)*where())+<-/ mul(371,760)why() who()(select()@mul(595,45)who()%how()'when()>how(){why()[mul(123,779)!@where()(mul(988,620)~'*,?/#when()mul(612,810)mul(720,939)]/(,^&how()%^]mul(391,308);&@-mul(525,708)+what(352,33)when()from()why()} ~mul(79,405)@*where()! mul(865,388) <mul(33,948)~?(}!??+from()why()mul(302,201)[{mul(585,486)mul(821,363)who(314,751)what()*,]{when()mul(101,727)]}#)mul(808,363):?&#why()select()+mul(98,877) select()~<what(651,799)+;~ )mul(766,538):[<:#[mul(501,413);!why()<&>?[$what()mul(747,941)#[}from() ((mul(418,822)mul(90,638)select()(#;;<[+@mul(657,611)]}@)mul(30,874)@mul(525,145))who() where()+:~+]mul(176,137)what()] mul(381,84)):how()<who()from():&when()+mul(175,258);who(818,691)mul(634,219){select(846,719)'where()what()^;)[#mul(648,322) $mul(127#<{#mul(965,174)mul(611,623)#?%;,:,don't()* when()}&&mul(952,606),>mul(315,467)%($'(*]:%mul(792,258)]>'mul(534+[#>&)+why()mul(881,357):^*?what()who(514,882)where())}-mul(88,883[;^-#mul(208,713)}?;]!%mul(651,918);{),:what()*mul(528,154)):@*]; &%[mul(542,543)mul(480,848)why()mul(843,903)[select())-*@ ;who()mul(77,706)<[;}mul(303,968));why()mul(916,126)&&%/&mul(462,652)[!~()what()from()from()select()how()mul(730,810/,when(286,584)don't()^select()mul(609,219)(-~&who():mul(135,454)from()-%~]#mul(909,564)when()&why(){/~+?who()[do()mul(852,307)-[?;)how()do()[[*->{!#^mul(678,864)>when()%>!']$mul(16,905),!mul(111,596)why()$mul(2,397)/-@}~;where(942,895)do()who()where()<}when()?mul(846,421),?(where()why(),how()(&mul(643,890)%~*[;% $what()don't()^$&(##mul(112,802)where()^ &(&&{&do()+(!(mul(732,198)[}!'>^%mul(919,810)mul(342,316))}what()&~:~$<when()do()*what()+:>mul(822,157)-,{select()who()mul(907,36>where()/$!^<&$where()mul(10,661)-who()mul(496,782)@%%?'{[;(mul(110,115)~mul(447,69)*[what()[{]>-'@mul(197,810)select()what()who()mul(492,647)where()*[{ [~&what()$mul(24%<>mul(234,703)"
        val cleaned = "mul(667,142)mul(139,116)mul(665,813)mul(589,293)mul(832,177)mul(701,929)mul(300,986)mul(238,716)mul(437,789)mul(662,564)mul(567,346)don't()mul(939,542)mul(944,786)mul(508,210)mul(873,534)mul(925,280)mul(858,972)mul(113,350)don't()mul(522,403)mul(627,14)mul(678,234)mul(520,505)mul(500,879)mul(163,615)mul(79,303)mul(752,220)don't()mul(454,158)mul(387,262)mul(904,366)mul(662,176)mul(259,178)mul(566,269)mul(21,147)don't()mul(883,511)mul(205,770)mul(538,114)mul(9,272)don't()mul(750,773)do()mul(316,235)mul(744,197mul(932,794)mul(371,760)mul(595,45)mul(123,779)mul(988,620)mul(612,810)mul(720,939)mul(391,308)mul(525,708)mul(79,405)mul(865,388)mul(33,948)mul(302,201)mul(585,486)mul(821,363)who(314,751)what()*,]{when()mul(101,727)]}#)mul(808,363):?&#why()select()+mul(98,877) select()~<what(651,799)+;~ )mul(766,538):[<:#[mul(501,413);!why()<&>?[$what()mul(747,941)#[}from() ((mul(418,822)mul(90,638)select()(#;;<[+@mul(657,611)]}@)mul(30,874)@mul(525,145))who() where()+:~+]mul(176,137)what()] mul(381,84)):how()<who()from():&when()+mul(175,258);who(818,691)mul(634,219){select(846,719)'where()what()^;)[#mul(648,322) $mul(127#<{#mul(965,174)mul(611,623)#?%;,:,don't()* when()}&&mul(952,606),>mul(315,467)%($'(*]:%mul(792,258)]>'mul(534+[#>&)+why()mul(881,357):^*?what()who(514,882)where())}-mul(88,883[;^-#mul(208,713)}?;]!%mul(651,918);{),:what()*mul(528,154)):@*]; &%[mul(542,543)mul(480,848)why()mul(843,903)[select())-*@ ;who()mul(77,706)<[;}mul(303,968));why()mul(916,126)&&%/&mul(462,652)[!~()what()from()from()select()how()mul(730,810/,when(286,584)don't()^select()mul(609,219)(-~&who():mul(135,454)from()-%~]#mul(909,564)when()&why(){/~+?who()[do()mul(852,307)-[?;)how()do()[[*->{!#^mul(678,864)>when()%>!']$mul(16,905),!mul(111,596)why()$mul(2,397)/-@}~;where(942,895)do()who()where()<}when()?mul(846,421),?(where()why(),how()(&mul(643,890)%~*[;% $what()don't()^$&(##mul(112,802)where()^ &(&&{&do()+(!(mul(732,198)[}!'>^%mul(919,810)mul(342,316))}what()&~:~$<when()do()*what()+:>mul(822,157)-,{select()who()mul(907,36>where()/$!^<&$where()mul(10,661)-who()mul(496,782)@%%?'{[;(mul(110,115)~mul(447,69)*[what()[{]>-'@mul(197,810)select()what()who()mul(492,647)where()*[{ [~&what()$mul(24%<>mul(234,703)"
        assertEquals(Day03.part2(value.parsed), 48L)
end Day03Test
